pipeline{
agent any
stages {
    stage('Checkout Source') {
      steps {
        git 'https://github.com/davidsmenesesc/rampup.git'
      }
    }  
    stage('Deploying App to Kubernetes') {
      steps {
        script {
        dir('kube') {
                // sh 'ls'
                // kubernetesDeploy(configs: "movie_analyst_ui.yaml", kubeconfigId: "kubernetes")
                // kubernetesDeploy(configs: "movie_analyst_api.yaml", kubeconfigId: "kubernetes")
            withKubeConfig([credentialsId: 'kube-config']) {
                    sh 'kubectl apply -f movie_analyst_ui.yaml'
                    sh 'kubectl apply -f movie_analyst_api.yaml'
               }
            }    
        }
      }
    }
  }
} 